<div id="cashier_container">

<div class="visible-xs hidden-print">
	<h3>Sorry. This page is not displayed in a small viewport.</h3>
</div>
<div class="row hidden-xs hidden-print" id="register" style="font-weight: bold;">
	<div id="orderlist" class="visible-lg col-lg-3" ng-class="{popup_orderlist: orderlist_on, 'visible-lg': !orderlist_on}">
		<div class="marginTop10">
			<table class="table table-striped" style="font-size: 18px; font-weight: bold; margin: 0 10px;">
	  			<tr ng-repeat="order in orders | orderByPriority | orderBy:'created_at':true | limitTo: 200" ng-class="{active: order.selected}">
	  				<td>
	  					<orderlist order="order" types="types" fullname="false" on-select="select_order(order)" save="save_order_state(order)"></orderlist>
	  				</td>
	  			</tr>
	  		</table>
	  	</div>
	</div>

	<div class="menu_container col-sm-7 col-md-8 col-lg-6">
		<div class="panel panel-primary" ng-show="order_details_on" style="margin: 0 10px 10px 10px;">
			<div class="panel-heading">
				<h3 class="panel-title">Order Details</h3>
			</div>
			<div class="panel-body">
				<div class="btn-group col-sm-12 col-md-7">
					<button type="button" class="btn btn-primary btn-lg" ng-repeat="type in types.orderTypes" ng-model="order.orderType" btn-radio="type.name">
						<span>{{type.name}}</span>
					</button>
				</div>
				<div class="btn-group col-sm-12 col-md-5">
					<button type="button" class="btn btn-primary btn-lg" ng-repeat="type in types.htTypes" ng-model="order.htType" btn-radio="type.name">
						<span>{{type.name}}</span>
					</button>
				</div>
				<div class="marginTop10 col-sm-12 col-md-7">
					<input type="text" class="form-control input-lg" ng-model="order.customer_name" typeahead="name.name for name in firstNames | filter:$viewValue | limitTo:8" placeholder="Customer name">
				</div>
				<div class="marginTop10 col-sm-12 col-md-7">
					<div>Appointment time: {{order.reserved_time | date:'shortTime'}}<span ng-hide="order.reserved_time">No</span></div>
					<div class="col-sm-6">
						<span ng-model="order.reserved_time" >
							<timepicker show-meridian="ismeridian"></timepicker>
						</span>
					</div>
					<div class="col-sm-6">
						<button class="btn btn-danger btn-lg marginTop10" ng-click="order.reserved_time=''" style="margin-left:10px">Time<br>Clear</button>
					</div>
				</div>
				<div class="marginTop10 col-sm-12 col-md-5">
					<!--
					<div>Order Id : {{order.id}}</div>
					<div class="text-center" style="font-size: 200%;">{{order.number}}</div>
				-->
					<div class="text-right" style="margin-top:30px" ng-show="order_modify">
						<button type="button" class="btn btn-default btn-lg" ng-click="cancel()">Cancel</button>
						<button type="button" class="btn btn-primary btn-lg" ng-click="detail_save()">Save</button>
					</div>
				</div>
			</div>
		</div>
		<div class="panel panel-primary" ng-show="payment_on" style="margin: 0 10px;">
			<div class="panel-heading">
				<h3 class="panel-title">Payment</h3>
			</div>
			<div class="panel-body">
				<div>
					<div class="col-sm-4 pull-left marginTop10">
						<button class="btn btn-default btn-lg btn-block" ng-class="{active:isUnpaid}" ng-click="clickUnpaid()">Unpaid</button>
					</div>
					<div class="col-sm-4 pull-left marginTop10">
						<button class="btn btn-default btn-lg btn-block" ng-class="{active:isCredit}" ng-click="clickCredit()">Credit</button>
					</div>
					<div class="col-sm-4 pull-left marginTop10">
						<input class="form-control input-lg" type="number" ng-model="order.cashReceived" style="height: 60px;">
					</div>
					<div class="col-sm-3 pull-left marginTop10" ng-repeat="bill in bills">
						<button class="btn btn-default btn-lg btn-block" ng-click="clickBill(bill)" ng-class="{active: bill.selected}">{{ bill.amount }}</button>
					</div>
				</div>
			</div>
		</div>
		<div ng-show="payment_on" class="col-sm-12 text-center clear panel-footer">
			<button type="button" class="btn btn-default btn-lg" ng-click="print()">Print</button>
			<button type="button" class="btn btn-default btn-lg" ng-click="cancel()">Cancel</button>
			<button type="submit" class="btn btn-primary btn-lg has-spinner" ng-click="submitOrder()">
				<span class="spinner"><i class="icon-spin icon-refresh"></i></span>
				Submit
			</button>
		</div>

		<div id="menutab" ng-hide="payment_on || order_details_on">
			<tabset justified="true" class="col-md-12">
			  	<tab heading="{{tab.name}}" ng-repeat="(key, tab) in tabGroups" select="setTabKey(key)">
					<div class="col-sm-4 col-md-3 menuitem" ng-repeat="menu in menus | orderByPriority | filter:{tabGroup:key} | filter:submenu | orderBy: ['priority']" style="padding: 0 5px" ng-show="!menu.parent || menuUpdateMode">
					<!--<div class="col-sm-4 col-md-3 menuitem" ng-repeat="menu in menus | orderByPriority | filter:{tabGroup:key} | filter:submenu | orderBy: ['priority']" style="padding: 0 5px" ng-show="!menu.parent || menuUpdateMode">-->
				  		<button class="menu btn btn-default btn-lg {{menu.backgroundColor}} {{menu.textColor}}" ng-click="addItem(menu, menu.$id)">
							<div>{{menu.abbr}}</div>
							<p class="{{menu.textColor}}">{{menu.name}}</p>
							<div ng-show="menu.type == 'Group'" class="tag blue">Group</div>
							<div class="tag red">{{menus[menus[menu.$id].parent].name}}</div>
				  		</button>
				  	</div>
					<div class="col-sm-4 col-md-3" style="padding: 0 5px" ng-show="menuUpdateMode">
				  		<button class="menu btn btn-default btn-lg" ng-click="addMenu()">
							<div class="blue">+</div>
				  		</button>
				  	</div>
			  	</tab>
			</tabset>
		</div>
	</div>

	<div class="col-sm-5 col-md-4 col-lg-3" id="cart_container">
		<div class="text-center" style="margin-bottom: 10px">
			<a href="#/"><button class="btn btn-danger">
				<span class="glyphicon glyphicon-home"></span>
			</button></a>
			<button class="btn btn-default" ng-click="scrollToggle()">
				<span class="{{scrollStateIcon}}"></span>
			</button>
			<button class="btn btn-success" ng-model="menuUpdateMode" btn-checkbox btn-checkbox-true=true btn-checkbox-false=false>
				<span class="glyphicon glyphicon-wrench"></span>
			</button>
			<button class="btn btn-success" ng-model="auto_print_on" btn-checkbox btn-checkbox-true=true btn-checkbox-false=false>
				<span class="glyphicon glyphicon-print"></span>
			</button>
			<button class="btn btn-primary" ng-model="orderlist_on" btn-checkbox btn-checkbox-true=true btn-checkbox-false=false>
				<span class="glyphicon glyphicon-list"></span>
			</button>
		</div>
	  	<!-- display normal mode -->
	  	<div id="receipt" ng-hide="menuUpdateMode">
		  	<div class="block blue pointer" ng-click="clickTotal()">
		  		<h2 class="pull-left" style="margin-bottom: 20px">Total:</h2>
		  		<h2 class="pull-right" style="margin-bottom: 20px">{{order.total | currency}}</h2>
		  		<h3 class="text-right clear text-red" ng-show="order.cashChange">Change : {{ order.cashChange | currency }}</h3>
		  	</div>
			<div class="list-group">
			  	<a href="" class="list-group-item list-group-item-warning" ng-repeat="item in order.items" ng-click="boolean.paymentOnly || openModal(item, $index)" ng-class="{active: item.selected}" ng-disabled="boolean.paymentOnly">
					<div>
			  			<!--<input type="checkbox" ng-show="(order.items.length>0)">-->
			  			<span>{{item.name}}</span>
			  			<span ng-show="item.qty-1"> X {{item.qty}}</span>
						<span class="pull-right">{{item.price * item.qty | currency}}</span>
					</div>
					<div><small>{{item | optionsToString}}</small></div>
			  	</a>
			</div>
			<div ng-show="hasItems">
			  	<div class="pull-right" style="color: #333">
				  	{{ order.subtotal | currency }} + {{ order.tax | currency }} = {{ order.total | currency }}
				</div><br>
			  	<button class="btn btn-warning btn-lg btn-block" ng-click="removeAllItems()" style="margin: 10px 0" ng-disabled="boolean.paymentOnly">Remove All</button>
			</div>
		</div>

		<!-- display menu update mode -->
		<div ng-show="menuUpdateMode && !menuSelectedMode">
			<p>Welcome to update mode!!</p>
			<!--
			<div ui-sortable ng-model="menuArray">
				<div ng-repeat="item in menuArray | orderByPriority | filter:{tabGroup:tabGroupKey}">
					{{item.name}}
				</div>
			</div>
		-->
		</div>
		<div ng-show="menuUpdateMode && menuSelectedMode">
			<table class="table">
				<tr>
					<td class="text-right">Name: </td>
					<td><input type="text" class="form-control" name="name" ng-model="newMenu.name" placeholder="Enter menu name"></td>
				</tr>
				<tr>
					<td class="text-right">Type: </td>
					<td>
						<select class="form-control" name="type" ng-model="newMenu.type">
							<option ng-repeat="type in types.menu">{{type}}</option>
						</select>
					</td>
				</tr>
				<tr>
					<td class="text-right">TabGroup: </td>
					<td>
						<select class="form-control" ng-model="newMenu.tabGroup">
							<option ng-repeat="(key, tab) in tabGroups" value="{{key}}">{{tab.name}}</option>
						</select>
					</td>
				</tr>
				<tr>
					<td class="text-right">Price: </td>
					<td>
						<input type="text" class="form-control" name="price" ng-model="newMenu.price" placeholder="Enter menu price">
					</td>
				</tr>
				<tr>
					<td class="text-right">Abbr: </td>
					<td>
						<input type="text" class="form-control" name="abbr" ng-model="newMenu.abbr" placeholder="Enter short name">
					</td>
				</tr>
				<tr>
					<td class="text-right">Type of Job: </td>
					<td>
						<select class="form-control" name="backgroundColor" ng-model="newMenu.job">
							<option value="Grill">Grill</option>
							<option value="Wok">Wok</option>
						</select>
					</td>
				</tr>
				<tr>
					<td class="text-right">Type of Rice: </td>
					<td>
						<select class="form-control" name="backgroundColor" ng-model="newMenu.rice">
							<option value="A">A: Teriyaki</option>
							<option value="B">B: Teri+Gyoza</option>
							<option value="C">C: Wok</option>
							<option value="D">D: Yakisoba</option>
							<option value="E">E: Katsu</option>
							<option value="F">F: FriedRice</option>
						</select>
					</td>
				</tr>
				<tr>
					<td class="text-right">Parent: </td>
					<td>
						<select class="form-control" name="parent" ng-model="newMenu.parent">
							<option value="">No Parent</option>
							<option ng-repeat="menu in menus | orderByPriority | filter:{type:'Group'}" value="{{menu.$id}}">{{menu.name}}</option>
						</select>
					</td>
				</tr>
				<tr>
					<td class="text-right">Priority: </td>
					<td><input type="number" class="form-control" name="priority" ng-model="newMenu.priority"></td>
				</tr>
				<tr>
					<td class="text-right">Kitchen No Display: </td>
					<td>
						<div class="btn-group">
							<button type="button" class="btn btn-primary" ng-model="newMenu.noDisplay" btn-checkbox btn-checkbox-true="1" btn-checkbox-false="0">
								No Display
							</button>
						</div>
					</td>
				</tr>
				<tr>
					<td class="text-right">Background Color: </td>
					<td>
						<select class="form-control" name="backgroundColor" ng-model="newMenu.backgroundColor">
							<option value="">No Color</option>
							<option ng-repeat="backgroundColor in types.backgroundColors" value="{{backgroundColor}}">{{backgroundColor}}</option>
						</select>
					</td>
				</tr>
				<tr>
					<td class="text-right">Text Color: </td>
					<td>
						<select class="form-control" name="textColor" ng-model="newMenu.textColor">
							<option value="">No Color</option>
							<option ng-repeat="textColor in types.textColors" value="{{textColor}}">{{textColor}}</option>
						</select>
					</td>
				</tr>
			</table>
			<div class="pull-right">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-warning" ng-click="deleteMenu()" data-dismiss="modal">Delete</button>
				<button type="button" class="btn btn-primary" ng-click="submitMenu()" data-dismiss="modal">{{newMenu.mode}}</button>
			</div>
		</div>

	</div>

</div>

<div class="modal hidden-print" id="optionModal" tabindex="-1" role="dialog" aria-labelledby="optionModalLabel" aria-hidden="true">
  	<div class="modal-dialog">
		<div class="modal-content">
	  	<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			<h4 class="modal-title" id="optionModalLabel">{{selectedItem.name}}</h4>
	  	</div>
	  	<div class="modal-body" class="row" style="overflow:hidden">
	  		<form name="myForm" role="form">
	  			<div class="col-md-6">
						<div class="form-group" ng-class="{error: myForm.name.$invalid}">
					    <label>Name : {{selectedItem.name}}</label>
					    <input type="text" class="form-control" name="name" ng-model="selectedItem.name" required>
					  </div>
						<div class="form-group" ng-class="{error: myForm.qty.$invalid}">
					    <label>Qty : {{selectedItem.qty}}</label>
					    <input type="number" class="form-control" name="qty" ng-model="selectedItem.qty" required>
					  </div>
						<div class="form-group" ng-class="{error: myForm.basePrice.$invalid}">
					    <label>Base Price : {{selectedItem.basePrice}}</label>
					    <input type="text" class="form-control" name="basePrice" ng-model="selectedItem.basePrice" required>
					  </div>
					</div>
					<div class="col-md-6">
						<div class="form-group" ng-class="{error: myForm.optionPrice.$invalid}">
					    	<label>Option Price : {{selectedItem.optionPrice}}</label>
					    	<input type="text" class="form-control" name="optionPrice" ng-model="selectedItem.optionPrice" required>
					  	</div>
						<div class="form-group" ng-class="{error: myForm.options.$invalid}">
					    	<label>Options : {{selectedItem | optionsToString}}</label>
					    	<div ng-repeat="(key, option) in selectedItem.options track by key">
					    		<input type="text" class="form-control" name="optionName" ng-model="option.name">
					    		<input type="text" class="form-control" name="optionPrice" ng-model="option.price">
					    	</div>
					  	</div>
						<div class="form-group" ng-class="{error: myForm.special_instruction.$invalid}">
					    	<label>Special Instruction : {{selectedItem.special_instruction}}</label>
					    	<input type="text" class="form-control" name="optionPrice" ng-model="selectedItem.special_instruction" required>
					  	</div>
					</div>
				</form>
	  	</div>
	  	<div class="modal-footer">
				<button type="button" class="btn btn-primary pull-left" ng-click="removeItem()" data-dismiss="modal">Remove</button>
				<button type="button" class="btn btn-default" data-dismiss="modal">Done</button>
	  	</div>
		</div>
  	</div>
</div>

<div id="group_menu_modal" class="modal hidden-print" tabindex="-1" role="dialog" aria-labelledby="gropu_menu_Label" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
    	<div class="modal-header">
    		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    		<h4 class="modal-title" id="gropu_menu_Label">{{menus[groupkey].name}}</h4>
    	</div>
		<div class="modal-body row">
			<div class="col-sm-3" ng-repeat="menu in menus | orderByPriority | filter:{parent:groupkey}" style="padding: 0 5px">
		  		<button class="menu btn btn-default btn-lg {{menu.backgroundColor}} {{menu.textColor}}" data-dismiss="modal" ng-click="addItem(menu)">
					<span>{{menu.abbr}}</span>
					<p class="{{menu.textColor}}">{{menu.name}}</p>
					<div class="tag red">{{menus[menus[menu.$id].parent].name}}</div>
		  		</button>
		  	</div>
		</div>
		<div class="modal-footer">
			<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		</div>
	</div>
  </div>
</div>

<div id="select_orderlist" class="modal hidden-print" tabindex="-1" role="dialog" aria-labelledby="select_orderlistLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
    	<div class="modal-header">
    		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    		<h4 class="modal-title" id="select_orderlistLabel">Selected Order</h4>
    	</div>
    	<div class="modal-body">
    		<ordersheet order="selected_order" types="types" ng-show="selected_order" on-save="save_order()" on-pay="go_payment()" on-cancel="selected_order=''"><ordersheet>
    	</div>
    	<div class="modal-footer">
			<button class="btn btn-default btn-lg" data-dismiss="modal" ng-click="print()">Print</button>
			<button class="btn btn-default btn-lg" data-dismiss="modal">Close</button>
			<button class="btn btn-primary btn-lg" ng-click="go_payment()" data-dismiss="modal" ng-show="selected_order.paymentType=='Unpaid'">Payment</button>
			<button class="btn btn-primary btn-lg" ng-click="go_refund()" data-dismiss="modal" ng-show="selected_order.paymentType!='Unpaid'">Refund</button>
			<button class="btn btn-primary btn-lg" ng-click="go_modify()" data-dismiss="modal">Modify</button>
			<button class="btn btn-primary btn-lg" ng-click="go_remove()" data-dismiss="modal" ng-show="selected_order.paymentType=='Unpaid'">Remove</button>
		</div>
	</div>
  </div>
</div>

<div id="processing" class="modal hidden-print" tabindex="-1" role="dialog" aria-labelledby="processinglistLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
    	<div class="modal-body">
    		<h2>Processing...</h2>
    	</div>
 	</div>
  </div>
</div>

<div class="visible-print" style="width:240px;" ng-include="'partials/newOrderTicket.html?v=1'">
</div>

</div>


